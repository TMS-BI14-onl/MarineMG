Well done!

2
-2
Solution is too hard.
In the view most inner query is not needed. Why do we need to separate window functions at all?

Mark: 8
